<section>
  <div class="g-title">
      <div class="container">
          <div class="row">
              <div class="col-sm-12">
                  <div style="display: flex;flex-direction: row;align-items: center;">
                      <div>
                          <mat-icon style="margin-top: 5px;margin-right: 10px;cursor: pointer;" (click)="volverListaProfesionales()">close</mat-icon>
                      </div>
                      <div>
                          <h1 style="font-weight: 400;">{{formNuevoProfesional.controls.primerNombre.value}} {{formNuevoProfesional.controls.segundoNombre.value}} 
                            {{formNuevoProfesional.controls.apellidoPaterno.value}} {{formNuevoProfesional.controls.apellidoMaterno.value}}
                            (Cód. {{formNuevoProfesional.controls.codmedico.value}})</h1>                            
                      </div>
                  </div>            
              </div>          
          </div>
      </div>
  </div>
  <div class="dashboard-body g-border-top h-myd-border--top-0">
      <div class="g-section-inner g-dashboard-section">
          <div class="container">
              <mat-tab-group mat-stretch-tabs>
                  <mat-tab label="DATOS GENERALES">
                    <div style="margin-top: 2rem;">
                        <mat-accordion class="expansion_panel" >
                          <mat-expansion-panel [expanded]="true" style="margin-bottom: 15px;">
                              <mat-expansion-panel-header style="justify-content: space-between;">
                                  <mat-panel-title style="font-weight: bold;">
                                      Información del profesional de la salud
                                  </mat-panel-title>
                                  <mat-panel-description style="display: contents;">
                                      <span class="material-icons" style="margin-right: 10px;color: black;cursor: pointer;" (click)="editarProfesional()">
                                          edit
                                      </span>
                                  </mat-panel-description>
                              </mat-expansion-panel-header>
                              <div class="clearfix g-box-content">
                                  <ul class="row g-list-md">
                                      <li class="col-md-4 clearfix cnt-item">
                                          <div class="col-sm-7 col-xs-6 item-label">Documento</div>
                                          <div class="col-sm-5 col-xs-6 item-dato">{{formNuevoProfesional.controls.numeroDocumento.value}}
                                          </div>
                                      </li>
                                      <li class="col-md-4 clearfix cnt-item">
                                          <div class="col-sm-7 col-xs-6 item-label">F. de Nacimiento</div>
                                          <div class="col-sm-5 col-xs-6 item-dato">{{formNuevoProfesional.controls.fechaNacimiento.value}}</div>
                                      </li>
                                      <li class="col-md-4 clearfix cnt-item">
                                          <div class="col-sm-7 col-xs-6 item-label">Género</div>
                                          <div class="col-sm-5 col-xs-6 item-dato">{{formNuevoProfesional.controls.genero.value == 'M'
                                            ? 'Masculino' : 'Femenino'}}</div>
                                      </li>
                                  </ul>
                                  <ul class="row g-list-md">
                                    <li class="col-md-4 clearfix cnt-item">
                                        <div class="col-sm-7 col-xs-6 item-label">Cód. Usuario</div>
                                        <div class="col-sm-5 col-xs-6 item-dato">{{formNuevoProfesional.controls.codigoUsuario.value}}
                                        </div>
                                    </li>
                                    <li class="col-md-4 clearfix cnt-item">
                                        <div class="col-sm-7 col-xs-6 item-label">CMP</div>
                                        <div class="col-sm-5 col-xs-6 item-dato">{{formNuevoProfesional.controls.cpm.value}}</div>
                                    </li>
                                </ul>
                              </div>
                          </mat-expansion-panel>
                        </mat-accordion>
                        <mat-accordion class="expansion_panel" >
                          <mat-expansion-panel [expanded]="true" style="margin-bottom: 15px;">
                              <mat-expansion-panel-header style="justify-content: space-between;">
                                  <mat-panel-title style="font-weight: bold;">
                                      Especialidades
                                  </mat-panel-title>
                                  <mat-panel-description style="display: contents;">
                                      <span class="material-icons" style="margin-right: 10px;color: black;cursor: pointer;" (click)="editarProfesional()">
                                          edit
                                      </span>
                                  </mat-panel-description>
                              </mat-expansion-panel-header>
                              <div style="padding: 15px;">
                                <div class="row" *ngFor="let espec of especialidadesSelected" style="margin-bottom: 15px;">
                                    <div class="col-md-12" style="border: 1px solid rgb(216, 216, 216);border-radius: 5px;overflow: hidden;
                                        box-shadow: none;">
                                        <div class="row">
                                            <div class="col-md-12" style="padding: 10px; background-color: white;color: black;display: flex;
                                            justify-content: space-between;">
                                                <b>({{espec.codigo}}) {{espec.descripcion}}</b>
                                            </div>
                                        </div>
                                        <div class="row" style="background-color: rgb(241, 241, 241)">
                                            <div class="col-md-12">
                                                <div class="row">
                                                  <div class="clearfix g-box-content">
                                                    <ul class="row g-list-md">
                                                        <li class="col-md-3 clearfix cnt-item">
                                                            <div class="col-sm-7 col-xs-6 item-label">RNE</div>
                                                            <div class="col-sm-5 col-xs-6 item-dato">{{espec.rne}}
                                                            </div>
                                                        </li>
                                                        <li class="col-md-4 clearfix cnt-item">
                                                            <div class="col-sm-7 col-xs-6 item-label">Tiempo de atención</div>
                                                            <div class="col-sm-5 col-xs-6 item-dato">{{espec.tiempo}} minutos</div>
                                                        </li>
                                                        <li class="col-md-5 clearfix cnt-item">
                                                            <div class="col-sm-2 col-xs-6 item-label">Sedes</div>
                                                            <div class="col-sm-10 col-xs-6 item-dato">{{espec.sedes}}
                                                            </div>
                                                        </li>
                                                    </ul>
                                                  </div>                                              
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                              </div>
                          </mat-expansion-panel>
                        </mat-accordion>
                        <mat-accordion class="expansion_panel">
                          <mat-expansion-panel [expanded]="true">
                              <mat-expansion-panel-header style="justify-content: space-between;">
                                  <mat-panel-title style="font-weight: bold;">
                                      Cargar Rúbrica del Médico
                                  </mat-panel-title>
                              </mat-expansion-panel-header>
                              <div class="clearfix g-box-content">
                                <form name="formUploadDocument" [formGroup]="formGroupUploadDocument">
                                  <div class="col-md-12">
                                    <div  class="drag-container" appDnd (fileDropped)="onFileDropped($event)">
                                      <input accept="image/png, image/gif, image/jpeg"  [ngStyle]="{'cursor': 'pointer'}" type="file" #fileDropRef id="fileDropRef"
                                        (change)="fileBrowseHandler($event.target.files, $event)" />
                                      <h3>Agrega o arrastre aquí la Rúbrica</h3>
                                    </div>
                                  </div>
                                  <div class="col-md-12" *ngIf=" getArrayLength()>0">
                                    <div class="col-md-8">
                                      <b> {{ getArrayLength() }} documento cargado</b>
                                    </div>
                                    <div class="col-md-4">
                                    </div>
                                  </div>
                                  <div class="col-md-12">
                                    <div class="files-list" formArrayName="items">
                                      <div class="single-file" *ngFor="let item of formGroupUploadDocument.get('items')['controls']; let i = index;">
                                        <div class="col-md-8">
            
                                          <div class="info">
                                            <h4 class="name" >
                                              {{ item.value.archivo.name }}
                                            </h4>
                                            <p class="size">
                                              {{ formatBytes(item.value.archivo.size ) }}
                                            </p>
                                          </div>
            
                                        </div>
                                        <div class="col-md-4">
                                          <div class="col-md-6">
                                            <div class="delete" (click)="deleteFile(i)">
                                              <span class="material-icons-outlined">
                                                
                                                <mat-icon matTooltip="Eliminar" matTooltipPosition='right'>delete_forever</mat-icon>
                                                </span>
                                            </div>
                                          </div>
                                          <div class="col-md-6" *ngIf="imageFile">
                                            <div class="delete" (click)="openModalRubrica()">
                                              <span class="material-icons-outlined">
                                                <mat-icon matTooltip="Mostrar Rúbrica" matTooltipPosition='right'>description</mat-icon>
                                                </span>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md-12">
                                    <div class="col-md-6"></div>
                                    <div class="col-md-3">
                                      <button type="button" class="g-btn g-btn-transparent block px-10"
                                        [disabled]="" (click)="return()">Cancelar</button>
                                    </div>
                                    <div class="col-md-3">
                                      <button type="button"  class="g-btn g-btn-verde block px-10"
                                      [disabled]="disableButton() || imageFile" (click)="uploadDocuments()">Cargar</button>
                                    </div>
                                  </div>
                                </form>

                              </div>
                          </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                  </mat-tab>
                  <mat-tab label="GESTIÓN DE HORARIOS">
                    <div class="dashboard-body g-border-top h-myd-border--top-0">
                      <div class="g-section-inner g-dashboard-section">
                        <div class="container">
                          <form name="formGroupSearchHorarios" [formGroup]="formGroupSearchHorarios" class="form-validate col-md-3"
                          (ngSubmit)="formGroupSearchHorariosSubmit(formGroupSearchHorarios)">
                            <div class="clearfix g-col-filter g-box-md fz14 gBgcGray5-md gBgcWhite1" id="filterBox"
                            [ngClass]="isFilterVisible ? 'show' : ''">
                            <div class="col-md-12 mb-ms-0 mb-xs-3 gH4 gCGray1">
                              <h2 class="pb-xs-1 hidden-xs hidden-sm"><b>Búsqueda de Horarios</b></h2>
    
                              <div id="show-filter" class="row pt-xs-2 pb-xs-2 gBgcGray5 g-border-bottom-xs hidden-md hidden-lg"
                                (click)="toggleFilter()">
                                <div class="col-xs-10">
                                  <h2><b>Búsqueda de Horarios</b></h2>
                                </div>
    
                                <div class="col-xs-2 g-text-right-xs">
                                  <span class="glyphicon"
                                    [ngClass]="isFilterVisible ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'"></span>
                                </div>
    
                                <div class="clearfix"></div>
                              </div>
                            </div>
                  
                              <div class="g-col-filter__box">
                                <div class="clearfix">
                                  <div class="col-md-12">
                                    <div class="row">   
                                      <div class="col-md-12">
                                        <b>Rango de Fechas</b>
                                      </div>       
                                      <div class="col-md-6 mb-xs-2 mb-md-0">
                                        <mat-form-field appearance="standard" class="form-group">
                                          <mat-label>Desde</mat-label>
                                          <input matInput [matDatepicker]="pickerFrom" autocomplete="off"
                                            (click)="pickerFrom.open()" formControlName="fecha_desde" >
                                          <mat-datepicker-toggle matSuffix [for]="pickerFrom" ></mat-datepicker-toggle>
                                          <mat-datepicker #pickerFrom ></mat-datepicker>
                                        </mat-form-field>
                                      </div>
                                      <div class="col-md-6">
                                        <mat-form-field appearance="standard" class="form-group">
                                          <mat-label>Hasta</mat-label>
                                          <input matInput [matDatepicker]="pickerTo" formControlName="fecha_hasta" autocomplete="off"
                                            (click)="pickerTo.open()" readonly>
                                          <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
                                          <mat-datepicker #pickerTo></mat-datepicker>
                                        </mat-form-field>
                                      </div>
                                              
                                      <div class="col-md-12">
                                        <mat-form-field appearance="standard" class="form-group">
                                          <mat-label>Sede</mat-label>
                                          <mat-select name="txtsede" formControlName="sede" (selectionChange)="seleccionarSede($event)">
                                            <mat-option *ngFor="let s of sedes" [value]="s.codigo">{{s.descripcion}}
                                            </mat-option>
                                          </mat-select>
                                        </mat-form-field>
                                      </div>
                  
                                      <div class="col-md-12">
                                        <mat-form-field appearance="standard" class="form-group">
                                          <mat-label>Especialidad</mat-label>
                                          <mat-select formControlName="especialidad" name="txtespecialidad">
                                            <mat-option *ngFor="let e of especialidades" [value]="e.codigo">{{e.descripcion}}
                                            </mat-option>
                                          </mat-select>
                                        </mat-form-field>
                                      </div>
                                      <div class="col-md-6 mb-xs-2 mb-md-0" *ngIf="true">
                                        <button type="button" class="g-btn g-btn-transparent block" (click)="clean()"
                                          [disabled]="false">Limpiar</button>
                                      </div>
                                      <div class="col-md-6" *ngIf="true">
                                        <button type="button" (click)="buscarHorarioFiltro()" class="g-btn g-btn-verde block"
                                          [disabled]="false">Filtrar</button>
                                      </div>
                                    </div>
                  
                                  </div>
                  
                                </div>
                              </div>
                            </div>
                          </form>
                          <div class="col-md-9">
                            <div class="row g-text-center-xs" *ngIf="!buscarHorario">
                              <mat-icon>info</mat-icon>
                              <div class="col-md-12 g-box-noresult-text">
                                Aún no se ha realizado la búsqueda de un horario.
                              </div>
                            </div>
                  
                            <div class="row" *ngIf="buscarHorario">
                              <div class="col-md-12" style="margin-bottom: 20px;" class="col-md-12 g-box-noresult-text">
                                <span class="subtitle">Horario: CM Mapfre Independencia - (0314) Medicina Interna.</span>
                              </div>
                              <div class="col-md-12">
                                <b>Rango de Horas</b>
                              </div>
                              <form [formGroup]="formRangoHorarios">
                                <div class="col-md-4">
                                  <div class="col-md-6" style="padding: 0;padding-right: 20px;">
                                    <input class="input-time" formControlName="hora_inicio" type="time" id="appt" name="appt">
                                  </div>
                                  <div class="col-md-6" style="padding: 0;padding-right: 20px;">
                                    <input class="input-time" formControlName="hora_fin" type="time" id="appt" name="appt">
                                  </div>
                                </div>
                              </form>
                              <div class="col-md-12">
                                <div class="col-md-12" style="margin-top: 2rem;">
                                  <span class="subtitle">Selecciona los días de atención</span>
                                </div>
                                <div class="col-md-4">
                                  <ejs-calendar id=calendar [values]='value' [min]="formGroupSearchHorarios.get('fecha_desde').value" [max]="formGroupSearchHorarios.get('fecha_hasta').value" (change)="onClick($event)"  [isMultiSelection]='multiselect'
                                  (renderDayCell)='disabledDate($event)'></ejs-calendar>
                                  <!-- <mat-form-field appearance="fill">
                                    <mat-label>Enter a date range</mat-label>
                                    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                                      <input matStartDate formControlName="start" placeholder="Start date">
                                      <input matEndDate formControlName="end" placeholder="End date">
                                    </mat-date-range-input>
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-date-range-picker #picker></mat-date-range-picker>
                                  
                                    <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Invalid start date</mat-error>
                                    <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
                                  </mat-form-field> -->
                                </div>
                                <div class="col-md-8">
                                  <div class="col-md-12" *ngIf="horarios.length == 0">
                                    <span class="subtitle">No existen horarios para el filtro seleccionado</span>
                                  </div>
                                  <div class="col-md-12"  *ngIf="horarios.length > 0">
                                    <span class="subtitle">Indica los horarios para cada día</span>
                                  </div>
                                  <div *ngFor="let h of horarios">
                                    <mat-card class="col-md-12 mat-elevation-z0" *ngIf="h.estado == 'V'" style="border-radius: 0px;border: 1px solid rgb(230, 230, 230);">
                                      <mat-card-content >
                                        <div class="row">
                                            <div class="col-md-5">
                                                   <!-- <span>{{h.diaDescripcion}} {{h.fechaDia}} de {{h.mesDescripcion}} {{h.anio}}</span> -->
                                                   <span> {{h.fechaInicio | dateActivity}}</span>
                                            </div>
                                            <div class="col-md-5">
                                              <div class="col-md-6" style="padding: 0;padding-right: 10px;">
                                                <input class="input-time" type="time" id="appt" name="appt" [(ngModel)]="h.horaInicio" required>
                                              </div>
                                              <div class="col-md-6" style="padding: 0;padding-right: 10px;">
                                                <input class="input-time" type="time" id="appt" name="appt" [(ngModel)]="h.horaFin" required disabled>
                                              </div>
                                            </div>
                                            <div class="col-md-2">
                                              <div class="col-md-6" style="padding: 0;padding-right: 10px;">
                                                <mat-icon style="cursor: pointer;" (click)="eliminarHorario(h)">delete</mat-icon>
                                              </div>
                                            </div>
                                        </div>
                                      </mat-card-content>
                                    </mat-card>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <br>
                            <div class="row margin-b-50" *ngIf="buscarHorario">
                              <div class="col-md-3 col-md-offset-6 mb-xs-2 mb-md-0" *ngIf="true">
                                <button type="button" class="g-btn g-btn-transparent block" (click)="clean()"
                                  [disabled]="false">Cancelar</button>
                              </div>
                              <div class="col-md-3" *ngIf="true">
                                <button type="button" (click)="aplicarHorario()" class="g-btn g-btn-verde block"
                                  [disabled]="horarios.length == 0">Aplicar Horario</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                      
                   
                  </mat-tab>
              </mat-tab-group>
          </div>
      </div>
  </div>
</section>

